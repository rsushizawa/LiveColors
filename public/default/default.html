<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML with Query Parameters from Original Request</title>
</head>
<body>
    <h1>HTML Page with JSON and Query Parameters</h1>
    <div id="jsonData"> Update query</div>
    <button onclick="updateQueryStringParameter('color', 'green')">Update</button>
    <button onclick="getQueryParamsJSON()">Get</button>
    <script>
        // função que separa os parametros query da pagina
        function getQueryParams() {
            const urlParams = new URLSearchParams(window.location.search);
            let query = {};
            for (const [key, value] of urlParams.entries()) {
                query[key] = value;
            }
            return query;
        }
        //função que atualiza os parametros query sem recarrgar a pagina
        function updateQueryStringParameter(paramName, paramValue) {
            const url = new URL(window.location.href);
            url.searchParams.set(paramName, paramValue);
            window.history.pushState({}, '', url);
        }

        // função que faz uma request para receber os parametros query em formato JSON
        function getQueryParamsJSON(){
            const queryParams = new URLSearchParams(window.location.search); // pega os parametros do link de busca
            fetch('/data?' + queryParams.toString())
                .then(response => response.json())
                .then(data => {
                    document.getElementById('jsonData').innerHTML = JSON.stringify(data);
                });
        }
    </script>
</body>
</html>