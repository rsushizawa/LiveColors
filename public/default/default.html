<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML with Query Parameters from Original Request</title>
    <link rel="stylesheet" href="default.css">
</head>
<body>
    <footer class="menu" id="menu">
        <img src="assets/logo.svg" alt="logo"> 
        <div class="menu_right">
            <a href="">One</a> 
            <a href="">Two</a> 
            <a href="">Three</a> 
            <a href="">Four</a>
            <button class="button_primary">Button</button>
            <button class="button_secondary">Button</button>
        </div>
    </footer>
    <div class="edit" style="text-align:center">
        <footer class="edit_hud" id="edit_hud">
            <button class="select_window" id="select_window"><img class="select_window_img" src="assets/select_window.svg" alt="select_window"></button>
            
            <button class="font_color" id="font_color" onclick="abrirSeletorCor('font_color', 'font_color_input')">Text</button>
            <input type="color" id="font_color_input" style="display: none;">

            <button class="background_color" id="background_color" style="width: 159px;" onclick="abrirSeletorCor('background_color', 'background_color_input')">Background</button>
            <input type="color" id="background_color_input" style="display: none;">
            
            <button class="primary_color" id="primary_color" onclick="abrirSeletorCor('primary_color', 'primary_color_input')">Primary</button>
            <input type="color" id="primary_color_input" style="display: none;">
            
            <button class="secondary_color" id="secondary_color" style="width: 133px;" onclick="abrirSeletorCor('secondary_color', 'secondary_color_input')">Secondary</button>
            <input type="color" id="secondary_color_input" style="display: none;">
            
            <button class="accent_color" id="accent_color" style="width: 106px;" onclick="abrirSeletorCor('accent_color', 'accent_color_input')">Accent</button>
            <input type="color" id="accent_color_input" style="display: none;">
            
            <button type="button" onclick="toggleSwitch" class="dark_mode_button" id="dark_mode"><svg class="dark_mode" width="29" height="29" viewBox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M14.5 28.25C12.5979 28.25 10.8104 27.8891 9.1375 27.1672C7.46458 26.4453 6.00938 25.4656 4.77187 24.2281C3.53437 22.9906 2.55469 21.5354 1.83281 19.8625C1.11094 18.1896 0.75 16.4021 0.75 14.5C0.75 12.5979 1.11094 10.8104 1.83281 9.1375C2.55469 7.46458 3.53437 6.00938 4.77187 4.77187C6.00938 3.53437 7.46458 2.55469 9.1375 1.83281C10.8104 1.11094 12.5979 0.75 14.5 0.75C16.4021 0.75 18.1896 1.11094 19.8625 1.83281C21.5354 2.55469 22.9906 3.53437 24.2281 4.77187C25.4656 6.00938 26.4453 7.46458 27.1672 9.1375C27.8891 10.8104 28.25 12.5979 28.25 14.5C28.25 16.4021 27.8891 18.1896 27.1672 19.8625C26.4453 21.5354 25.4656 22.9906 24.2281 24.2281C22.9906 25.4656 21.5354 26.4453 19.8625 27.1672C18.1896 27.8891 16.4021 28.25 14.5 28.25ZM15.875 25.3969C18.6021 25.0531 20.888 23.8557 22.7328 21.8047C24.5776 19.7536 25.5 17.3188 25.5 14.5C25.5 11.6812 24.5776 9.24635 22.7328 7.19531C20.888 5.14427 18.6021 3.94688 15.875 3.60313V25.3969Z" fill="black"/>
                </svg>
            </button>
            <button class="randomize" id="randomize" style="width: 80px;"><img class="randomize" src="assets/randomize.svg" alt="randomize"> <img src="assets/segment.svg" alt="segment"> <img class="arrow_top" src="assets/arrow_top.svg" alt="arrow_top"></button>
            <button class="button1" id="undo"><img class="undo" src="assets/undo.svg" alt="undo"></button>
            <button class="button1" id="redo"><img class="redo" src="assets/redo.svg" alt="redo"></button>
            <button class="select_fonts" id="select_fonts" style="width: 92px;">Fonts</button>
            <button class="button1" id="share"><img class="share" src="assets/share.svg" alt="share"></button>
            <button class="button1" id="visibility"><img class="visibility" src="assets/visibility.svg" alt="visibility"></button>
        </footer>
    </div>
    <div class="intro2">
        <div class="intro" id="intro">
            <h2>Medium length hero headline goes here</h2>
            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Amet accusamus et maxime nostrum officia assumenda mollitia nam totam numquam libero est magnam ipsa sint, blanditiis animi tempora aut possimus iste.</p>
            <button class="button_intro1">Button</button>
            <button class="button_intro2">Button</button>
        </div>

        <div class="palette">
            <svg width="400" height="459" viewBox="0 0 400 459" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M200 459L393.176 347.712C396.894 345.57 399.186 341.605 399.186 337.314V229.5V114.75L200 212V459Z" fill="var(--accent)"/>
                <path d="M200 459L393.176 347.712C396.894 345.57 399.186 341.605 399.186 337.314V229.5V114.75L200 212V459Z" fill="none" fill-opacity="0.2"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M194.01 3.45094C197.718 1.31487 202.282 1.31487 205.99 3.45093L399.186 114.75L200 212L0.814148 114.75L194.01 3.45094Z" fill="var(--primary)"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M194.01 3.45094C197.718 1.31487 202.282 1.31487 205.99 3.45093L399.186 114.75L200 212L0.814148 114.75L194.01 3.45094Z" fill="none" fill-opacity="0.2"/>
                <path d="M0.814148 337.314C0.814148 341.605 3.10562 345.57 6.82395 347.712L200 459V212L0.814148 114.75V337.314Z" fill="var(--secondary)"/>
                <path d="M0.814148 337.314C0.814148 341.605 3.10562 345.57 6.82395 347.712L200 459V212L0.814148 114.75V337.314Z" fill="none" fill-opacity="0.2"/>
                <path d="M10.8141 130.761L190 218.246V441.698L11.8158 339.047C11.1961 338.69 10.8141 338.029 10.8141 337.314V130.761ZM200 200.872L22.1129 114.021L199.002 12.1159C199.62 11.7599 200.38 11.7599 200.998 12.1159L377.887 114.021L200 200.872ZM389.186 130.761V229.5V337.314C389.186 338.029 388.804 338.69 388.184 339.047L210 441.698V218.246L389.186 130.761Z" stroke="var(--font_color)" stroke-width="20"/>
                <path d="M314 158.197V292.663C314 293.37 313.627 294.024 313.02 294.384L201.02 360.771C200.391 361.143 199.609 361.143 198.98 360.771L86.9802 294.384C86.3726 294.024 86 293.37 86 292.663V159.337C86 158.63 86.3726 157.976 86.9802 157.616L198.98 91.2292C199.609 90.8565 200.391 90.8565 201.02 91.2292L314 158.197Z" fill="none"/>
                <path d="M314 158.197V292.663C314 293.37 313.627 294.024 313.02 294.384L201.02 360.771C200.391 361.143 199.609 361.143 198.98 360.771L86.9802 294.384C86.3726 294.024 86 293.37 86 292.663V159.337C86 158.63 86.3726 157.976 86.9802 157.616L198.98 91.2292C199.609 90.8565 200.391 90.8565 201.02 91.2292L314 158.197Z" fill="var(--background)"/>
                <path d="M314 158.197V292.663C314 293.37 313.627 294.024 313.02 294.384L201.02 360.771C200.391 361.143 199.609 361.143 198.98 360.771L86.9802 294.384C86.3726 294.024 86 293.37 86 292.663V159.337C86 158.63 86.3726 157.976 86.9802 157.616L198.98 91.2292C199.609 90.8565 200.391 90.8565 201.02 91.2292L314 158.197Z" stroke="var(--font_color)" stroke-width="20"/>
            </svg>
        </div>
    </div>
</body>
<script>
    // Função dinâmica que abre o seletor de cor e altera a cor do botão
    function abrirSeletorCor(idBotao, idInputCor) {
        const inputCor = document.getElementById(idInputCor);
        const botao = document.getElementById(idBotao);
        var key = botao.innerText;
        // Simula o clique no input de cor
        inputCor.click();
        inputCor.addEventListener('input', function() {
            var color = inputCor.value;
            botao.style.backgroundColor = color;
            //atualiza a variável do CSS
            
            //joga na url a cor selecionada
            updateColorsQueryParam(key, `${color}`);
            updateCSSVar(key);
        });                
    }

    // função que separa os parametros query da pagina
    function getQueryParams() {
        const urlParams = new URLSearchParams(window.location.search);
        let query = {};
        for (const [key, value] of urlParams.entries()) {
            query[key] = value;
        }
        return query;
    }

    // função que organiza as cores do getQueryParams()
    function getColors(){
        let data = getQueryParams()
        console.log(data.colors)
        let colors = []
        let builder = ''
        for( let i = 0; i<=data.colors.length;i++){
            if(data.colors[i]=='-' || i == data.colors.length){
                colors.push(builder)
                builder = ''
            } else {
                builder += data.colors[i]
            }
        }

        return colors;
    }

    //função que atualiza os parametro do Colors
    function updateColorsQueryParam(paramName, paramValue) {
        let colorsArray = getColors();
        switch(paramName){
            case 'Text':
                colorsArray[0]=paramValue;
                break;
            case 'Background':
                colorsArray[1]=paramValue;
                break;
            case 'Primary':
                colorsArray[2]=paramValue;
                break;
            case 'Secondary':
                colorsArray[3]=paramValue;
                break;
            case 'Accent':
                colorsArray[4]=paramValue;
                break;
            default:
                break;
        }

        let res = `${colorsArray[0]}-${colorsArray[1]}-${colorsArray[2]}-${colorsArray[3]}-${colorsArray[4]}`

        const url = new URL(window.location.href);
        url.searchParams.set('colors', res);
        window.history.pushState({}, '', url);
    }

    function updateCSSVar(){
        const colors = getColors()
        const colorObj = {
            Text: `${colors[0]}`,
            Background: `${colors[1]}`,
            Primary: `${colors[2]}`,
            Secondary: `${colors[3]}`,
            Accent: `${colors[4]}`
        }
        var r = document.querySelector(':root');
        for (const key in colorObj) {
            console.log(`--${key}`)
            console.log(colorObj)
            console.log(`${colorObj[key]}`)
            if (colorObj.hasOwnProperty(key)) {
                r.style.setProperty(`--${key}`, `${colorObj[key]}`);
            }
        }
    }
</script>
</html>     